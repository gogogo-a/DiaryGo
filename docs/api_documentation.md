***\base_url\***=https://connivently-fitted-grayce.ngrok-free.app/api/v1



| 状态码 | 含义           |
| ------ | -------------- |
| 200    | 成功           |
| 500    | 服务器内部错误 |
| 400    | 请求参数错误   |
| 404    | 资源不存在     |
| 401    | 未授权         |
| 403    | 禁止访问       |

# DiaryGo API 文档

## 目录

1. [用户认证](#用户认证)
2. [用户管理](#用户管理)
3. [账单管理](#账单管理)
4. [账本管理](#账本管理)
5. [账本用户权限](#账本用户权限)
6. [标签管理](#标签管理)
7. [日记管理](#日记管理)

## 用户认证

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 用户登录 | 通过微信code获取用户信息并登录 | /api/v1/auth/wx-login | POST | Content-Type: application/json | JSON | ```{ "code": "0b3v9FGa1kldfD0ozaJa1sBcGZ3v9FGF" }``` | ```{ "code": 200, "message": "", "data": { "user": {...}, "token": "..." } }``` | ```{ "code": 200, "message": "成功", "data": { "user": { "id": "uuid-string-here", "plant_id": "微信openid", "plant_form": "wechat", "user_name": "微信用户", "password": "", "avatar": "", "email": "", "phone": "", "gender": "", "birthday": "0001-01-01T00:00:00Z", "address": "", "remark": "", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" }, "token": "eyJhbGciOiJI..." } }``` | ```{ "code": 500, "message": "微信API返回错误: invalid appid, rid: 68c90372-2b669432-6b53d6f4", "data": null }``` | 后续请求必须携带token |

## 用户管理

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 获取用户列表 | 获取用户列表，支持分页和关键词搜索 | /api/v1/users | GET | Authorization: Bearer {token} | 无 | page: 页码，默认为1<br>page_size: 每页数量，默认为10，最大100<br>keyword: 搜索关键词 | ```{ "code": 200, "message": "", "data": { "list": [...], "total": 100, "page": 1, "page_size": 10 } }``` | ```{ "code": 200, "message": "", "data": { "list": [ { "id": "uuid-string-here", "plant_id": "微信openid", "plant_form": "wechat", "user_name": "微信用户", "avatar": "", "email": "", "phone": "", "gender": "", "birthday": "0001-01-01T00:00:00Z", "address": "", "remark": "", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ], "total": 1, "page": 1, "page_size": 10 } }``` | ```{ "code": 401, "message": "未找到用户信息", "data": null }``` | 需要认证 |
| 获取用户详情 | 获取特定用户的详细信息 | /api/v1/users/:id | GET | Authorization: Bearer {token} | 无 | id: 用户ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "id": "uuid-string-here", "plant_id": "微信openid", "plant_form": "wechat", "user_name": "微信用户", "avatar": "", "email": "", "phone": "", "gender": "", "birthday": "0001-01-01T00:00:00Z", "address": "", "remark": "", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "用户不存在", "data": null }``` | 需要认证 |

## 账单管理

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 创建账单 | 创建新账单 | /api/v1/bills | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "account_book_id": "账本UUID", "amount": 100.00, "type": "income/expense", "tag_ids": ["标签UUID1", "标签UUID2"], "bill_time": "2023-01-01T00:00:00Z", "remark": "备注", "image_url": "图片URL" }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "创建账单成功", "data": { "id": "uuid-string-here", "account_book_id": "账本UUID", "user_id": "用户UUID", "amount": 100.00, "type": "income", "tags": [{"id": "标签UUID1", "tag_name": "工资"}, {"id": "标签UUID2", "tag_name": "兼职"}], "remark": "备注", "image_url": "图片URL", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 403, "message": "您没有权限访问此账本", "data": null }``` | 需要认证，且必须有对应账本的访问权限。支持多个标签关联到同一个账单 |
| 获取账单列表 | 获取账单列表，支持分页和多条件搜索 | /api/v1/bills | GET | Authorization: Bearer {token} | 无 | account_book_id: 账本ID (必填)<br>page: 页码，默认为1<br>page_size: 每页数量，默认为10，最大100<br>type: 账单类型 (income/expense)<br>tag_ids: 标签ID数组，多个以逗号分隔<br>start_time: 开始时间 (YYYY-MM-DD)<br>end_time: 结束时间 (YYYY-MM-DD)<br>min_amount: 最小金额<br>max_amount: 最大金额<br>keyword: 搜索关键词 | ```{ "code": 200, "message": "", "data": { "list": [...], "total": 100, "page": 1, "page_size": 10 } }``` | ```{ "code": 200, "message": "", "data": { "list": [ { "id": "uuid-string-here", "account_book_id": "账本UUID", "user_id": "用户UUID", "amount": 100.00, "type": "income", "tags": [{"id": "标签UUID1", "tag_name": "工资"}, {"id": "标签UUID2", "tag_name": "兼职"}], "remark": "备注", "image_url": "图片URL", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ], "total": 1, "page": 1, "page_size": 10 } }``` | ```{ "code": 403, "message": "您没有权限访问此账本", "data": null }``` | 需要认证，且必须有对应账本的访问权限。支持按多个标签筛选 |
| 更新账单 | 更新账单信息 | /api/v1/bills/:id | PUT | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "account_book_id": "账本UUID", "amount": 100.00, "type": "income/expense", "tag_ids": ["标签UUID1", "标签UUID2"], "bill_time": "2023-01-01T00:00:00Z", "remark": "备注", "image_url": "图片URL" }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "更新账单成功", "data": { "id": "uuid-string-here", "account_book_id": "账本UUID", "user_id": "用户UUID", "amount": 100.00, "type": "income", "tags": [{"id": "标签UUID1", "tag_name": "工资"}, {"id": "标签UUID2", "tag_name": "兼职"}], "remark": "备注", "image_url": "图片URL", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "账单不存在", "data": null }``` | 需要认证，且必须有对应账本的访问权限。更新时会先删除原有标签关联，然后重新创建新的标签关联 |
| 删除账单 | 删除账单 | /api/v1/bills/:id | DELETE | Authorization: Bearer {token} | 无 | id: 账单ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "删除账单成功", "data": null }``` | ```{ "code": 403, "message": "您没有权限访问此账本", "data": null }``` | 需要认证，且必须有对应账本的访问权限。删除账单的同时会删除相关的账单标签关联 |
| 获取账单详情 | 获取账单详细信息 | /api/v1/bills/:id | GET | Authorization: Bearer {token} | 无 | id: 账单ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "id": "uuid-string-here", "account_book_id": "账本UUID", "user_id": "用户UUID", "amount": 100.00, "type": "income", "tags": [{"id": "标签UUID1", "tag_name": "工资"}, {"id": "标签UUID2", "tag_name": "兼职"}], "remark": "备注", "image_url": "图片URL", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "账单不存在", "data": null }``` | 需要认证，且必须有对应账本的访问权限。返回账单详情包括关联的标签信息 |
| 获取账单统计 | 获取账单统计信息 | /api/v1/bills/stats | GET | Authorization: Bearer {token} | 无 | account_book_id: 账本ID (必填)<br>start_time: 开始时间 (YYYY-MM-DD)<br>end_time: 结束时间 (YYYY-MM-DD)<br>group_by: 分组方式 (day/week/month/year) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "total_income": 1000.00, "total_expense": 500.00, "net_amount": 500.00, "group_stats": [ { "group_key": "2025-09", "income": 1000.00, "expense": 500.00, "net_amount": 500.00 } ], "tag_stats": { "工资": 1000.00, "餐饮": 300.00, "交通": 200.00 } } }``` | ```{ "code": 403, "message": "您没有权限访问此账本", "data": null }``` | 需要认证，且必须有对应账本的访问权限。按标签统计会统计关联到不同标签的账单金额 |

## 账本管理

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 创建账本 | 创建新账本 | /api/v1/account-books | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "name": "我的账本", "description": "这是我的个人账本" }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "创建成功", "data": { "id": "uuid-string-here", "name": "我的账本", "description": "这是我的个人账本", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 400, "message": "请求参数错误", "data": null }``` | 需要认证，创建者自动成为账本的管理员 |
| 获取账本列表 | 获取当前用户有权限访问的所有账本 | /api/v1/account-books | GET | Authorization: Bearer {token} | 无 | 无 | ```{ "code": 200, "message": "", "data": [...] }``` | ```{ "code": 200, "message": "", "data": [ { "id": "uuid-string-here", "name": "我的账本", "description": "这是我的个人账本", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ] }``` | ```{ "code": 401, "message": "未找到用户信息", "data": null }``` | 需要认证 |
| 更新账本 | 更新账本信息 | /api/v1/account-books/:id | PUT | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "name": "新账本名称" }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "更新成功", "data": { "id": "uuid-string-here", "name": "新账本名称", "description": "这是我的个人账本", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 403, "message": "您没有权限修改此账本", "data": null }``` | 需要认证，且必须有对应账本的访问权限 |
| 删除账本 | 删除账本 | /api/v1/account-books/:id | DELETE | Authorization: Bearer {token} | 无 | id: 账本ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "删除成功", "data": null }``` | ```{ "code": 403, "message": "您没有权限删除此账本", "data": null }``` | 需要认证，且必须是账本的管理员 |
| 获取账本详情 | 获取账本详细信息 | /api/v1/account-books/:id | GET | Authorization: Bearer {token} | 无 | id: 账本ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "id": "uuid-string-here", "name": "我的账本", "description": "这是我的个人账本", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "账本不存在", "data": null }``` | 需要认证，且必须有对应账本的访问权限 |

## 账本用户权限

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 获取账本用户列表 | 获取账本的所有用户 | /api/v1/account-book-users/book/:bookId | GET | Authorization: Bearer {token} | 无 | bookId: 账本ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": [...] }``` | ```{ "code": 200, "message": "", "data": [ { "id": "uuid-string-here", "plant_id": "微信openid", "plant_form": "wechat", "user_name": "微信用户", "avatar": "", "email": "", "phone": "", "gender": "", "birthday": "0001-01-01T00:00:00Z", "address": "", "remark": "", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ] }``` | ```{ "code": 404, "message": "账本不存在或您没有权限", "data": null }``` | 需要认证，且必须有对应账本的访问权限 |
| 授予账本权限 | 管理员为其他用户授予账本访问权限 | /api/v1/account-book-users/grant | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "account_book_id": "账本UUID", "user_id": "用户UUID" }``` | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "成功授予用户访问权限", "data": null }``` | ```{ "code": 403, "message": "您没有权限授予此账本的访问权限", "data": null }``` | 需要认证，且必须是账本的管理员（第一个用户） |
| 撤销账本权限 | 管理员撤销其他用户的账本访问权限 | /api/v1/account-book-users/revoke | DELETE | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "account_book_id": "账本UUID", "user_id": "用户UUID" }``` | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "成功撤销用户访问权限", "data": null }``` | ```{ "code": 404, "message": "该用户没有此账本的权限", "data": null }``` | 需要认证，且必须是账本的管理员（第一个用户），管理员不能撤销自己的权限 | 

## 标签管理

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 创建标签 | 创建新标签 | /api/v1/tags | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "tag_name": "工资", "type": "收入", "category": "bill" }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "创建标签成功", "data": { "id": "uuid-string-here", "tag_name": "工资", "type": "收入", "category": "bill", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 400, "message": "同名标签已存在", "data": null }``` | 需要认证。category 只能是 bill 或 diary，分别对应账单标签和日记标签。同一分类下不允许创建同名标签 |
| 批量创建标签 | 批量创建多个标签 | /api/v1/tags/batch | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "tags": [{ "tag_name": "工资", "type": "收入", "category": "bill" }, { "tag_name": "旅游", "type": "生活", "category": "diary" }] }``` | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "批量创建标签成功", "data": null }``` | ```{ "code": 400, "message": "无效的标签分类: other", "data": null }``` | 需要认证。批量创建时，如果某个标签已存在，会自动跳过该标签，继续处理其他标签 |
| 获取标签列表 | 获取标签列表，可按分类过滤 | /api/v1/tags | GET | Authorization: Bearer {token} | 无 | category: 标签分类（bill/diary），可选 | ```{ "code": 200, "message": "", "data": [...] }``` | ```{ "code": 200, "message": "", "data": [ { "id": "uuid-string-here", "tag_name": "工资", "type": "收入", "category": "bill", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ] }``` | ```{ "code": 400, "message": "无效的标签分类", "data": null }``` | 需要认证。不传category参数时返回所有标签，传入category参数时只返回指定分类的标签 |
| 获取标签详情 | 获取标签详细信息 | /api/v1/tags/:id | GET | Authorization: Bearer {token} | 无 | id: 标签ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "id": "uuid-string-here", "tag_name": "工资", "type": "收入", "category": "bill", "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "标签不存在", "data": null }``` | 需要认证 |
| 更新标签 | 更新标签信息 | /api/v1/tags/:id | PUT | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "tag_name": "月薪", "type": "收入", "category": "bill" }``` | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "更新标签成功", "data": null }``` | ```{ "code": 400, "message": "同名标签已存在", "data": null }``` | 需要认证。更新标签时会检查同名冲突，不允许与其他标签同名 |
| 删除标签 | 删除标签 | /api/v1/tags/:id | DELETE | Authorization: Bearer {token} | 无 | id: 标签ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "删除标签成功", "data": null }``` | ```{ "code": 400, "message": "标签已被使用，无法删除", "data": null }``` | 需要认证。如果标签已被账单或日记使用，则无法删除 |

## 日记管理

| 接口名称 | 接口功能 | URL | 请求方法 | 请求头 | 请求体 (格式) | 请求参数 | 响应结构 | 成功响应示例 | 失败响应示例 | 备注 |
|---------|---------|-----|----------|-------|--------------|----------|----------|--------------|--------------|------|
| 创建日记 | 创建新日记 | /api/v1/diaries | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "title": "我的旅行日记", "content": "今天去了长城...", "tag_ids": ["标签UUID1", "标签UUID2"], "permission_ids": ["权限UUID1"], "image_ids": ["图片UUID1"], "video_ids": ["视频UUID1"] }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "创建日记成功", "data": { "id": "uuid-string-here", "title": "我的旅行日记", "content": "今天去了长城...", "tags": [{"id": "标签UUID1", "tag_name": "旅游"}], "permissions": [{"id": "权限UUID1", "name": "私密"}], "images": [...], "videos": [...], "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 400, "message": "请求参数错误", "data": null }``` | 需要认证。创建日记时会同时创建日记-用户关系，将创建者设为日记的所有者。同时创建日记-标签关系和日记-权限关系。图片和视频ID为可选参数 |
| 获取日记列表 | 获取日记列表，支持分页和条件筛选 | /api/v1/diaries | GET | Authorization: Bearer {token} | 无 | page: 页码，默认为1<br>page_size: 每页数量，默认为10，最大100<br>keyword: 搜索关键词<br>tag_id: 标签ID<br>permission_id: 权限ID | ```{ "code": 200, "message": "", "data": { "list": [...], "total": 100, "page": 1, "page_size": 10 } }``` | ```{ "code": 200, "message": "", "data": { "list": [ { "id": "uuid-string-here", "title": "我的旅行日记", "content": "今天去了长城...", "tags": [...], "permissions": [...], "like": 5, "is_liked": true, "user": {...}, "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } ], "total": 1, "page": 1, "page_size": 10 } }``` | ```{ "code": 401, "message": "未找到用户信息", "data": null }``` | 需要认证。返回的日记列表会包含日记的基本信息、标签、权限、点赞数，以及当前用户是否点赞(is_liked)。只返回用户有权限查看的日记 |
| 获取日记详情 | 获取日记详细信息 | /api/v1/diaries/:id | GET | Authorization: Bearer {token} | 无 | id: 日记ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "id": "uuid-string-here", "title": "我的旅行日记", "content": "今天去了长城...", "tags": [...], "permissions": [...], "images": [...], "videos": [...], "like": 5, "is_liked": true, "user": {...}, "created_at": "2025-09-16T12:34:56Z", "updated_at": "2025-09-16T12:34:56Z" } }``` | ```{ "code": 404, "message": "日记不存在", "data": null }``` | 需要认证。返回日记的完整信息，包括内容、关联的标签、权限、图片、视频等，以及点赞数和当前用户是否已点赞。只有在用户有权限查看的情况下才会返回数据 |
| 更新日记 | 更新日记信息 | /api/v1/diaries/:id | PUT | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "title": "更新后的标题", "content": "更新后的内容", "tag_ids": ["标签UUID1", "标签UUID2"], "permission_ids": ["权限UUID1"], "image_ids": ["图片UUID1"], "video_ids": ["视频UUID1"] }``` | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "更新日记成功", "data": {...} }``` | ```{ "code": 403, "message": "您没有权限更新此日记", "data": null }``` | 需要认证。只有日记的创建者或共享了编辑权限的用户可以更新日记。更新时会删除原有的标签、权限、图片、视频关联，然后重新创建新的关联 |
| 删除日记 | 删除日记 | /api/v1/diaries/:id | DELETE | Authorization: Bearer {token} | 无 | id: 日记ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "删除日记成功", "data": null }``` | ```{ "code": 403, "message": "只有创建者可以删除日记", "data": null }``` | 需要认证。只有日记的原始创建者才能删除日记，共享用户即使有编辑权限也不能删除。删除日记会同时删除相关的标签关联、权限关联、用户关联、图片关联、视频关联 |
| 分享日记 | 与其他用户共享日记 | /api/v1/diaries/:id/share | POST | Authorization: Bearer {token}<br>Content-Type: application/json | JSON | ```{ "user_id": "用户UUID", "permission_ids": ["权限UUID1"] }``` | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "分享日记成功", "data": null }``` | ```{ "code": 403, "message": "您没有权限分享此日记", "data": null }``` | 需要认证。只有日记的创建者可以分享日记给其他用户，并指定权限（如只读、可编辑等）。系统会创建日记-用户关系和日记-权限关系 |
| 点赞日记 | 给日记点赞 | /api/v1/diaries/:id/like | POST | Authorization: Bearer {token} | 无 | id: 日记ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "点赞成功", "data": null }``` | ```{ "code": 400, "message": "您已经点赞过该日记", "data": null }``` | 需要认证。用户只能给同一日记点赞一次，重复点赞会返回错误。点赞会增加日记的点赞数，并创建日记-点赞记录 |
| 取消点赞 | 取消对日记的点赞 | /api/v1/diaries/:id/unlike | POST | Authorization: Bearer {token} | 无 | id: 日记ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": null }``` | ```{ "code": 200, "message": "取消点赞成功", "data": null }``` | ```{ "code": 400, "message": "您尚未点赞该日记", "data": null }``` | 需要认证。只有之前点赞过的用户才能取消点赞。取消点赞会减少日记的点赞数，并删除对应的日记-点赞记录 |
| 检查点赞状态 | 检查用户是否已点赞某日记 | /api/v1/diaries/:id/check-like | GET | Authorization: Bearer {token} | 无 | id: 日记ID (UUID格式，通过URL路径参数传递) | ```{ "code": 200, "message": "", "data": {...} }``` | ```{ "code": 200, "message": "", "data": { "is_liked": true } }``` | ```{ "code": 404, "message": "日记不存在", "data": null }``` | 需要认证。返回当前用户是否已点赞该日记。这个功能在获取日记列表和日记详情时已包含，这个接口主要用于单独检查点赞状态 | 